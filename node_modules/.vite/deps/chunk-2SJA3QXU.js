import {
  joinStrings
} from "./chunk-KFGQ7LSZ.js";
import {
  FormFieldContext,
  useFormFieldContext
} from "./chunk-RGNJKKON.js";
import {
  InfoLinkLabelContext
} from "./chunk-U4MR2ZVK.js";
import {
  internal_default as internal_default2
} from "./chunk-XJWEAZ5Y.js";
import {
  useInternalI18n
} from "./chunk-VCW6C342.js";
import {
  FunnelMetrics,
  useFunnel,
  useFunnelStep,
  useFunnelSubStep
} from "./chunk-GC32QG33.js";
import {
  DATA_ATTR_FIELD_ERROR,
  DATA_ATTR_FIELD_LABEL,
  getFieldSlotSeletor,
  getNameFromSelector,
  getSubStepAllSelector
} from "./chunk-37SB7DJX.js";
import {
  useUniqueId
} from "./chunk-3TE4OIE4.js";
import {
  internal_default
} from "./chunk-NUCDU4ZC.js";
import {
  __rest,
  clsx_m_default,
  getBaseProps,
  useVisualRefresh
} from "./chunk-CHBULPAM.js";
import {
  __toESM,
  require_react
} from "./chunk-S2TLTWWO.js";

// node_modules/@cloudscape-design/components/form-field/internal.js
var import_react = __toESM(require_react());

// node_modules/@cloudscape-design/components/form-field/util.js
function makeSlotId(prop, formFieldId, propName) {
  if (!prop) {
    return void 0;
  }
  return `${formFieldId}-${propName}`;
}
function getSlotIds(formFieldId, label, description, constraintText, errorText) {
  const ids = {
    label: makeSlotId(label, formFieldId, "label"),
    description: makeSlotId(description, formFieldId, "description"),
    constraint: makeSlotId(constraintText, formFieldId, "constraint"),
    error: makeSlotId(errorText, formFieldId, "error")
  };
  return ids;
}
function getAriaDescribedBy({ error, description, constraint }) {
  const describedByAttributes = [error, description, constraint].filter((e) => !!e);
  const describedBy = describedByAttributes.length ? describedByAttributes.join(" ") : void 0;
  return describedBy;
}
function getGridDefinition(stretch, secondaryControlPresent, isRefresh) {
  let columns;
  if (stretch) {
    columns = [{ colspan: 12 }, { colspan: 12 }];
  } else if (isRefresh) {
    columns = [{ colspan: { default: 12, xs: 8 } }, { colspan: { default: 12, xs: 4 } }];
  } else {
    columns = [{ colspan: { default: 12, xs: 9 } }, { colspan: { default: 12, xs: 3 } }];
  }
  if (!secondaryControlPresent) {
    return [columns[0]];
  }
  return columns;
}

// node_modules/@cloudscape-design/components/form-field/styles.css.js
import "/home/bryanchasko/code/rgc3/node_modules/@cloudscape-design/components/form-field/styles.scoped.css";
var styles_css_default = {
  "error-icon-shake-wrapper": "awsui_error-icon-shake-wrapper_14mhv_av9zi_103",
  "awsui-motion-shake-horizontally": "awsui_awsui-motion-shake-horizontally_14mhv_av9zi_1",
  "error-icon-scale-wrapper": "awsui_error-icon-scale-wrapper_14mhv_av9zi_130",
  "awsui-motion-scale-popup": "awsui_awsui-motion-scale-popup_14mhv_av9zi_1",
  "error": "awsui_error_14mhv_av9zi_103",
  "awsui-motion-fade-in-0": "awsui_awsui-motion-fade-in-0_14mhv_av9zi_1",
  "root": "awsui_root_14mhv_av9zi_174",
  "label": "awsui_label_14mhv_av9zi_210",
  "info": "awsui_info_14mhv_av9zi_224",
  "description": "awsui_description_14mhv_av9zi_229",
  "constraint": "awsui_constraint_14mhv_av9zi_230",
  "hints": "awsui_hints_14mhv_av9zi_237",
  "constraint-has-error": "awsui_constraint-has-error_14mhv_av9zi_238",
  "secondary-control": "awsui_secondary-control_14mhv_av9zi_242",
  "controls": "awsui_controls_14mhv_av9zi_246",
  "label-hidden": "awsui_label-hidden_14mhv_av9zi_246",
  "control": "awsui_control_14mhv_av9zi_246",
  "error__message": "awsui_error__message_14mhv_av9zi_264",
  "visually-hidden": "awsui_visually-hidden_14mhv_av9zi_268"
};

// node_modules/@cloudscape-design/components/form-field/internal.js
function FormFieldError({ id, children, errorIconAriaLabel }) {
  const i18n = useInternalI18n("form-field");
  return import_react.default.createElement(
    "div",
    { id, className: styles_css_default.error },
    import_react.default.createElement(
      "div",
      { className: styles_css_default["error-icon-shake-wrapper"] },
      import_react.default.createElement(
        "div",
        { role: "img", "aria-label": i18n("i18nStrings.errorIconAriaLabel", errorIconAriaLabel), className: styles_css_default["error-icon-scale-wrapper"] },
        import_react.default.createElement(internal_default, { name: "status-warning", size: "small" })
      )
    ),
    import_react.default.createElement("span", { className: styles_css_default.error__message }, children)
  );
}
function ConstraintText({ id, hasError, children }) {
  return import_react.default.createElement("div", { id, className: clsx_m_default(styles_css_default.constraint, hasError && styles_css_default["constraint-has-error"]) }, children);
}
function InternalFormField(_a) {
  var { controlId, stretch = false, label, info, i18nStrings, children, secondaryControl, description, constraintText, errorText, __hideLabel, __internalRootRef = null, __disableGutters = false } = _a, rest = __rest(_a, ["controlId", "stretch", "label", "info", "i18nStrings", "children", "secondaryControl", "description", "constraintText", "errorText", "__hideLabel", "__internalRootRef", "__disableGutters"]);
  const baseProps = getBaseProps(rest);
  const isRefresh = useVisualRefresh();
  const instanceUniqueId = useUniqueId("formField");
  const generatedControlId = controlId || instanceUniqueId;
  const formFieldId = controlId || generatedControlId;
  const { funnelInteractionId, submissionAttempt, funnelState, errorCount } = useFunnel();
  const { stepNumber, stepNameSelector } = useFunnelStep();
  const { subStepSelector, subStepNameSelector } = useFunnelSubStep();
  const slotIds = getSlotIds(formFieldId, label, description, constraintText, errorText);
  const ariaDescribedBy = getAriaDescribedBy(slotIds);
  const gridDefinition = getGridDefinition(stretch, !!secondaryControl, isRefresh);
  const { ariaLabelledby: parentAriaLabelledby, ariaDescribedby: parentAriaDescribedby, invalid: parentInvalid } = useFormFieldContext({});
  const contextValuesWithoutControlId = {
    ariaLabelledby: joinStrings(parentAriaLabelledby, slotIds.label) || void 0,
    ariaDescribedby: joinStrings(parentAriaDescribedby, ariaDescribedBy) || void 0,
    invalid: !!errorText || !!parentInvalid
  };
  const analyticsAttributes = {
    [DATA_ATTR_FIELD_LABEL]: slotIds.label ? getFieldSlotSeletor(slotIds.label) : void 0,
    [DATA_ATTR_FIELD_ERROR]: slotIds.error ? getFieldSlotSeletor(slotIds.error) : void 0
  };
  (0, import_react.useEffect)(() => {
    var _a2, _b, _c;
    if (funnelInteractionId && errorText && funnelState.current !== "complete") {
      const stepName = getNameFromSelector(stepNameSelector);
      const subStepName = getNameFromSelector(subStepNameSelector);
      errorCount.current++;
      const errorIsVisible = ((_c = (_b = (_a2 = __internalRootRef === null || __internalRootRef === void 0 ? void 0 : __internalRootRef.current) === null || _a2 === void 0 ? void 0 : _a2.getBoundingClientRect()) === null || _b === void 0 ? void 0 : _b.width) !== null && _c !== void 0 ? _c : 0) > 0;
      if (errorIsVisible) {
        FunnelMetrics.funnelSubStepError({
          funnelInteractionId,
          subStepSelector,
          subStepName,
          subStepNameSelector,
          stepNumber,
          stepName,
          stepNameSelector,
          fieldErrorSelector: `${getFieldSlotSeletor(slotIds.error)} .${styles_css_default.error__message}`,
          fieldLabelSelector: getFieldSlotSeletor(slotIds.label),
          subStepAllSelector: getSubStepAllSelector()
        });
      }
      return () => {
        errorCount.current--;
      };
    }
  }, [funnelInteractionId, errorText, submissionAttempt, errorCount]);
  return import_react.default.createElement(
    "div",
    Object.assign({}, baseProps, { className: clsx_m_default(baseProps.className, styles_css_default.root), ref: __internalRootRef }, analyticsAttributes),
    import_react.default.createElement(
      "div",
      { className: clsx_m_default(__hideLabel && styles_css_default["visually-hidden"]) },
      label && import_react.default.createElement("label", { className: styles_css_default.label, id: slotIds.label, htmlFor: generatedControlId }, label),
      import_react.default.createElement(InfoLinkLabelContext.Provider, { value: slotIds.label }, !__hideLabel && info && import_react.default.createElement("span", { className: styles_css_default.info }, info))
    ),
    description && import_react.default.createElement("div", { className: styles_css_default.description, id: slotIds.description }, description),
    import_react.default.createElement(
      "div",
      { className: clsx_m_default(styles_css_default.controls, __hideLabel && styles_css_default["label-hidden"]) },
      import_react.default.createElement(
        internal_default2,
        { gridDefinition, disableGutters: __disableGutters },
        import_react.default.createElement(FormFieldContext.Provider, { value: Object.assign({ controlId: generatedControlId }, contextValuesWithoutControlId) }, children && import_react.default.createElement("div", { className: styles_css_default.control }, children)),
        secondaryControl && import_react.default.createElement(
          FormFieldContext.Provider,
          { value: contextValuesWithoutControlId },
          import_react.default.createElement("div", { className: styles_css_default["secondary-control"] }, secondaryControl)
        )
      )
    ),
    (constraintText || errorText) && import_react.default.createElement(
      "div",
      { className: styles_css_default.hints },
      errorText && import_react.default.createElement(FormFieldError, { id: slotIds.error, errorIconAriaLabel: i18nStrings === null || i18nStrings === void 0 ? void 0 : i18nStrings.errorIconAriaLabel }, errorText),
      constraintText && import_react.default.createElement(ConstraintText, { id: slotIds.constraint, hasError: !!errorText }, constraintText)
    )
  );
}

export {
  FormFieldError,
  ConstraintText,
  InternalFormField
};
//# sourceMappingURL=chunk-2SJA3QXU.js.map
